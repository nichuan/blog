<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="nichuan&#39;s blog">
<meta property="og:url" content="http://www.nichuan.top/index.html">
<meta property="og:site_name" content="nichuan&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="nichuan&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"left"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.nichuan.top/">





  <title>nichuan's blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">nichuan's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-jvm-xss/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-jvm-xss/" itemprop="url">Java - 局部变量和StackOverflowError</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-15T17:17:54+08:00">
                2018-10-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-jvm.jpg" alt=""></p>
<h2 id="本文目的"><a href="#本文目的" class="headerlink" title="本文目的"></a>本文目的</h2><p>对Java栈内存进行简单学习总结，并了解 <code>-Xss</code> JVM参数的配置，<strong>学会在代码中尽量减少不必要的局部变量声明</strong>，从而提高程序效率和编码水平。</p>
<h2 id="Java栈内存简介"><a href="#Java栈内存简介" class="headerlink" title="Java栈内存简介"></a>Java栈内存简介</h2><p>Java栈内存空间中主要存放的是局部变量，包括基本数据类型（<code>int</code>、<code>short</code>、<code>byte</code>、<code>long</code>、<code>float</code>、<code>double</code>、<code>char</code>、<code>boolean</code>）和引用数据类型。例如：<code>int a = 1</code> 或者 <code>double x = 0.01</code> 这类代码声明的变量将会<strong>直接存放在栈空间中</strong>；而 <code>Date today = new Date()</code> 则会将引用对象 <code>today</code> 放在<strong>栈</strong>内存中，它引用的真正对象 <code>Date()</code> 则会存放在<strong>堆</strong>空间中，本文只讨论栈内存，不讨论堆内存。</p>
<p>引用对象类型可能是一个指向对象起始地址的引用指针，也可能是一个指向代表对象的句柄或其他与此对象相关的位置和 <code>returnAddress</code> 类型（指向了一条字节码指令的地址）。</p>
<p>64位的 <code>long</code> 和 <code>double</code> 会占用 <code>2</code> 个局部变量空间，其他类型只占用 1 个局部变量空间。 </p>
<h2 id="StackOverFlowError-什么时候会发生"><a href="#StackOverFlowError-什么时候会发生" class="headerlink" title="StackOverFlowError 什么时候会发生"></a>StackOverFlowError 什么时候会发生</h2><p>如果我们在一段程序里面分配大量的局部变量，就可能造成栈内存空间不足，引发 <code>java.lang.StackOverFlowError</code> 错误。要模拟一个 <code>StackOverFlowError</code> 错误，最简单的方法就是使用递归。</p>
<p>那么，怎么设置这个栈内存空间的大小呢，那就是 <code>-Xss</code> 参数。 </p>
<h2 id="Xss参数的配置"><a href="#Xss参数的配置" class="headerlink" title="-Xss参数的配置"></a>-Xss参数的配置</h2><p><code>-Xss</code> 参数用来设置栈内存空间的大小，例如 <code>-Xss128K</code> 指分配 <code>128K</code> 的栈内存大小。为什么是 <code>128K</code> 而不是 <code>1K</code> 或者 <code>10K</code> 呢？这个数值的大小可以随便设置吗？ </p>
<p>我们不妨尝试一下，随便写一个含有 <code>main</code> 方法的Java程序，然后在 <code>IDEA</code> 中运行，指定 <code>VM参数</code> 为 <code>-Xss10K</code>，如下图所示：</p>
<p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/java-jvm-xss-1.jpg" alt="IDEA设置-Xss参数"><br><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/java-jvm-xss-2.jpg" alt="IDEA设置-Xss参数"></p>
<p>运行程序，会得到如下错误（注意如果设置为1K，该参数可能不会生效而是采用初始的栈内存大小）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error: Could not create the Java Virtual Machine.</span><br><span class="line">The stack size specified is too small, Specify at least 104k</span><br><span class="line">Error: A fatal exception has occurred. Program will exit.</span><br></pre></td></tr></table></figure>
<p>可以看出，JVM对于栈内存的大小是有最低要求的，<strong>不能低于 104K</strong>。经测试，当设置稍微低于 <code>104K</code> 的时候，程序有时候也是可以运行的，但尽量不要这样做。</p>
<p>下面，就通过程序代码来实战 <code>StackOverFlowError</code> 错误。</p>
<h2 id="JavaXssDemo1"><a href="#JavaXssDemo1" class="headerlink" title="JavaXssDemo1"></a>JavaXssDemo1</h2><p>这个例子中，递归方法体里面有 <code>x1</code>、<code>x2</code> 两个局部变量。加入 <code>-Xss104k</code> JVM参数，运行以下程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Java - 栈内存大小设置Demo1</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaXssDemo1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归深度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归测试（包含少量局部变量）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">recursionWithFewVariables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> x1 = <span class="number">1</span>, x2 = <span class="number">2</span>;</span><br><span class="line">        count++;</span><br><span class="line">        recursionWithFewVariables();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 程序入口</span></span><br><span class="line"><span class="comment">     * -Xss104k</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 运行参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            recursionWithFewVariables();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"递归测试（包含少量局部变量long），调用深度 = "</span> + count);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">递归测试（包含少量局部变量），调用深度 = 785</span><br><span class="line">java.lang.StackOverflowError</span><br><span class="line">	at me.zebe.cat.java.jvm.JavaXssDemo1.recursionWithFewVariables(JavaXssDemo1.java:19)</span><br></pre></td></tr></table></figure>
<h2 id="JavaXssDemo2"><a href="#JavaXssDemo2" class="headerlink" title="JavaXssDemo2"></a>JavaXssDemo2</h2><p>这个例子中，，将 JavaXssDemo1 中的局部变量从 <strong>2</strong> 个增加到 <strong>10</strong> 个。加入 <code>-Xss104k</code> JVM参数，运行以下程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Java - 栈内存大小设置Demo2</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaXssDemo2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归深度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归测试（包含多个局部变量）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">recursionWithMoreVariables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> x1 = <span class="number">1</span>, x2 = <span class="number">2</span>, x3 = <span class="number">3</span>, x4 = <span class="number">4</span>, x5 = <span class="number">5</span>, x6 = <span class="number">6</span>, x7 = <span class="number">7</span>, x8 = <span class="number">8</span>, x9 = <span class="number">9</span>, x10 = <span class="number">10</span>;</span><br><span class="line">        count++;</span><br><span class="line">        recursionWithMoreVariables();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 程序入口</span></span><br><span class="line"><span class="comment">     * -Xss104k</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 运行参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            recursionWithMoreVariables();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"递归测试（包含多个局部变量long），调用深度 = "</span> + count);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">递归测试（包含多个局部变量），调用深度 = 363</span><br><span class="line">java.lang.StackOverflowError</span><br><span class="line">	at me.zebe.cat.java.jvm.JavaXssDemo2.recursionWithMoreVariables(JavaXssDemo2.java:19)</span><br></pre></td></tr></table></figure>
<h2 id="JavaXssDemo3"><a href="#JavaXssDemo3" class="headerlink" title="JavaXssDemo3"></a>JavaXssDemo3</h2><p>这个例子中，将 JavaXssDemo2 中的局部变量类型由 <code>long</code> 改为 <code>int</code>，数量不变 （还是10个）。加入 <code>-Xss104k</code> JVM参数，运行以下程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Java - 栈内存大小设置Demo3</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaXssDemo3</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归深度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归测试（包含多个局部变量）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">recursionWithMoreVariables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x1 = <span class="number">1</span>, x2 = <span class="number">2</span>, x3 = <span class="number">3</span>, x4 = <span class="number">4</span>, x5 = <span class="number">5</span>, x6 = <span class="number">6</span>, x7 = <span class="number">7</span>, x8 = <span class="number">8</span>, x9 = <span class="number">9</span>, x10 = <span class="number">10</span>;</span><br><span class="line">        count++;</span><br><span class="line">        recursionWithMoreVariables();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 程序入口</span></span><br><span class="line"><span class="comment">     * -Xss104k</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 运行参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            recursionWithMoreVariables();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"递归测试（包含多个局部变量int），调用深度 = "</span> + count);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">递归测试（包含多个局部变量），调用深度 = 551</span><br><span class="line">java.lang.StackOverflowError</span><br><span class="line">	at me.zebe.cat.java.jvm.JavaXssDemo3.recursionWithMoreVariables(JavaXssDemo3.java:19)</span><br></pre></td></tr></table></figure>
<h2 id="对比及思考"><a href="#对比及思考" class="headerlink" title="对比及思考"></a>对比及思考</h2><table>
<thead>
<tr>
<th>栈空间大小</th>
<th>局部变量类型</th>
<th>局部变量个数</th>
<th>调用深度</th>
</tr>
</thead>
<tbody>
<tr>
<td>104K</td>
<td>long</td>
<td>2</td>
<td>785</td>
</tr>
<tr>
<td>104K</td>
<td>long</td>
<td>10</td>
<td>363</td>
</tr>
<tr>
<td>104K</td>
<td>int</td>
<td>10</td>
<td>551</td>
</tr>
</tbody>
</table>
<p>通过以上例子可以看出：</p>
<ul>
<li>在相同的栈内存空间下，局部变量越少，可以递归调用的次数越多</li>
<li>相反，如果有过多的局部变量，则会<strong>增加栈内存的开销</strong>。</li>
</ul>
<p>同时，<code>long</code> 类型是64位，它会占用 <strong>2</strong> 个局部变量空间，而 <code>int</code> 占用的是 <strong>1</strong> 个局部变量空间。</p>
<p>因此，我们应当在编写程序的过程中，<strong>合理地使用栈空间，尽量减少不必要的局部变量分配，特别是在递归方法中尤其要谨慎使用局部变量</strong>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-string-join-collector/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-string-join-collector/" itemprop="url">Java8 - 更优雅的字符串连接(join)收集器 Collectors.joining</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-15T08:43:21+08:00">
                2018-10-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="Java8中的字符串连接收集器"><a href="#Java8中的字符串连接收集器" class="headerlink" title="Java8中的字符串连接收集器"></a>Java8中的字符串连接收集器</h2><p>在JDK8中，可以采用函数式编程（使用 <code>Collectors.joining 收集器</code>）的方式对字符串进行更优雅的连接。<br><code>Collectors.joining 收集器</code> 支持灵活的参数配置，可以指定字符串连接时的 <strong>分隔符</strong>，<strong>前缀</strong> 和 <strong>后缀</strong> 字符串。</p>
<p>代码参考如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义人名数组</span></span><br><span class="line"><span class="keyword">final</span> String[] names = &#123;<span class="string">"Zebe"</span>, <span class="string">"Hebe"</span>, <span class="string">"Mary"</span>, <span class="string">"July"</span>, <span class="string">"David"</span>&#125;;</span><br><span class="line">Stream&lt;String&gt; stream1 = Stream.of(names);</span><br><span class="line">Stream&lt;String&gt; stream2 = Stream.of(names);</span><br><span class="line">Stream&lt;String&gt; stream3 = Stream.of(names);</span><br><span class="line"><span class="comment">// 拼接成 [x, y, z] 形式</span></span><br><span class="line">String result1 = stream1.collect(Collectors.joining(<span class="string">", "</span>, <span class="string">"["</span>, <span class="string">"]"</span>));</span><br><span class="line"><span class="comment">// 拼接成 x | y | z 形式</span></span><br><span class="line">String result2 = stream2.collect(Collectors.joining(<span class="string">" | "</span>, <span class="string">""</span>, <span class="string">""</span>));</span><br><span class="line"><span class="comment">// 拼接成 x -&gt; y -&gt; z] 形式</span></span><br><span class="line">String result3 = stream3.collect(Collectors.joining(<span class="string">" -&gt; "</span>, <span class="string">""</span>, <span class="string">""</span>));</span><br><span class="line">System.out.println(result1);</span><br><span class="line">System.out.println(result2);</span><br><span class="line">System.out.println(result3);</span><br></pre></td></tr></table></figure>
<p>程序输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Zebe, Hebe, Mary, July, David]</span><br><span class="line">Zebe | Hebe | Mary | July | David</span><br><span class="line">Zebe -&gt; Hebe -&gt; Mary -&gt; July -&gt; David</span><br></pre></td></tr></table></figure></p>
<h2 id="一般的做法（不推荐）"><a href="#一般的做法（不推荐）" class="headerlink" title="一般的做法（不推荐）"></a>一般的做法（不推荐）</h2><p>在JAVA8出现之前，我们通常使用循环的方式来拼接字符串，这样做不仅代码冗长丑陋，而且需要仔细阅读代码才知道代码的功能，例如下面的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String[] names = &#123;<span class="string">"Zebe"</span>, <span class="string">"Hebe"</span>, <span class="string">"Mary"</span>, <span class="string">"July"</span>, <span class="string">"David"</span>&#125;;</span><br><span class="line">StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; names.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (builder.length() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        builder.append(<span class="string">","</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    builder.append(names[i]);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(builder.toString());</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-stream-partitioning-by/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-stream-partitioning-by/" itemprop="url">Java8 - 对流(数据)进行自定义分块：partitioningBy收集器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-27T16:22:02+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="partitioningBy收集器"><a href="#partitioningBy收集器" class="headerlink" title="partitioningBy收集器"></a>partitioningBy收集器</h2><p>在JDK8中，可以对流进行方便的自定义分块，通常是根据某种过滤条件将流一分为二。</p>
<p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/java-8-stream-partitioning-by.png" alt=""></p>
<p>例如：有一组人名，包含中文和英文，在 JDK8 中可以通过 <code>partitioningBy</code> 收集器将其区分开来。 </p>
<p>下面是代码例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个包含人名称的流（英文名和中文名）</span></span><br><span class="line">Stream&lt;String&gt; stream = Stream.of(<span class="string">"Alen"</span>, <span class="string">"Hebe"</span>, <span class="string">"Zebe"</span>, <span class="string">"张成瑶"</span>, <span class="string">"钟其林"</span>);</span><br><span class="line"><span class="comment">// 通过判断人名称的首字母是否为英文字母，将其分为两个不同流</span></span><br><span class="line"><span class="keyword">final</span> Map&lt;Boolean, List&lt;String&gt;&gt; map = stream.collect(Collectors.partitioningBy(s -&gt; &#123;</span><br><span class="line">    <span class="comment">// 如果是英文字母，则将其划分到英文人名，否则划分到中文人名</span></span><br><span class="line">    <span class="keyword">int</span> code = s.codePointAt(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> (code &gt;= <span class="number">65</span> &amp;&amp; code &lt;= <span class="number">90</span>) || (code &gt;= <span class="number">97</span> &amp;&amp; code &lt;= <span class="number">122</span>);</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// 输出分组结果</span></span><br><span class="line">map.forEach((isEnglishName, names) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (isEnglishName) &#123;</span><br><span class="line">        System.out.println(<span class="string">"英文名称如下："</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"中文名称如下："</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    names.forEach(name -&gt; System.out.println(<span class="string">"\t"</span> + name));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>程序输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">中文名称如下：</span><br><span class="line">	张成瑶</span><br><span class="line">	钟其林</span><br><span class="line">英文名称如下：</span><br><span class="line">	Alen</span><br><span class="line">	Hebe</span><br><span class="line">	Zebe</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-stream-grouping-by/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-stream-grouping-by/" itemprop="url">Java8 - 对流(数据)进行自定义分组：groupingBy收集器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-27T16:06:13+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="groupingBy收集器"><a href="#groupingBy收集器" class="headerlink" title="groupingBy收集器"></a>groupingBy收集器</h2><p>在JDK8中，可以对流进行方便的自定义分组，就像 <code>SQL</code> 语句中的 <code>groupBy</code> 一样，在JDK8中对应的分组函数是 <code>Collectors</code> 类的 <code>groupingBy</code> 方法。这种特性很有用：<strong>把数据拆分成不同的组，可以使处理数据更加灵活方便，在某些情况下例如按需处理、分块处理时更高效</strong>。</p>
<p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/java-8-stream-grouping-by.png" alt=""></p>
<p>例如：有一组人名，需要根据首字母（姓氏）进行分组，则可以通过 <code>groupingBy</code> 分组函数方便地实现。</p>
<p>下面是代码例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个包含人名称的流</span></span><br><span class="line">Stream&lt;String&gt; stream = Stream.of(<span class="string">"Alen"</span>, <span class="string">"Hebe"</span>, <span class="string">"Zebe"</span>, <span class="string">"Helen"</span>, <span class="string">"Alex"</span>);</span><br><span class="line"><span class="comment">// 通过人名称的首字母进行分组</span></span><br><span class="line"><span class="keyword">final</span> Map&lt;Character, List&lt;String&gt;&gt; map = stream.collect(Collectors.groupingBy(s -&gt; s.charAt(<span class="number">0</span>)));</span><br><span class="line"><span class="comment">// 输出分组结果</span></span><br><span class="line">map.forEach((letter, groups) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">"以字母 "</span> + letter + <span class="string">" 开头的名字如下："</span>);</span><br><span class="line">    groups.forEach(name -&gt; System.out.println(<span class="string">"\t"</span> + name));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>程序输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">以字母 A 开头的名字如下：</span><br><span class="line">	Alen</span><br><span class="line">	Alex</span><br><span class="line">以字母 H 开头的名字如下：</span><br><span class="line">	Hebe</span><br><span class="line">	Helen</span><br><span class="line">以字母 Z 开头的名字如下：</span><br><span class="line">	Zebe</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-map-for-each/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-map-for-each/" itemprop="url">Java8 - Map更优雅的迭代方式：forEach</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-27T15:43:50+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="BiConsumer"><a href="#BiConsumer" class="headerlink" title="BiConsumer"></a>BiConsumer</h2><p>用于两个参数之间进行操作的函数式接口是 <code>BiConsumer</code>。这个函数式接口正好用来操作 <code>Map</code> 的 <code>key</code> 和 <code>value</code>。JDK8强化了针对 <code>Map</code> 类的迭代方式，新增了一个默认方法 <code>forEach</code>，它接收一个 <code>BiConsumer</code> 函数。JDK给出的描述如下：</p>
<blockquote>
<p>Performs the given action for each entry in this map until all entries have been processed or the action throws an exception.（对该映射中的每个条目执行给定的操作，直到所有条目已被处理或动作抛出异常为止。）</p>
</blockquote>
<p>下面是代码例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个Map</span></span><br><span class="line">Map&lt;String, Object&gt; infoMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">infoMap.put(<span class="string">"name"</span>, <span class="string">"Zebe"</span>);</span><br><span class="line">infoMap.put(<span class="string">"site"</span>, <span class="string">"www.zebe.me"</span>);</span><br><span class="line">infoMap.put(<span class="string">"email"</span>, <span class="string">"zebe@vip.qq.com"</span>);</span><br><span class="line"><span class="comment">// 传统的Map迭代方式</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : infoMap.entrySet()) &#123;</span><br><span class="line">    System.out.println(entry.getKey() + <span class="string">"："</span> + entry.getValue());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// JDK8的迭代方式</span></span><br><span class="line">infoMap.forEach((key, value) -&gt; &#123;</span><br><span class="line">    System.out.println(key + <span class="string">"："</span> + value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-map-compute-if-absent/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-map-compute-if-absent/" itemprop="url">Java8 - Map新增的方法：computeIfAbsent</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-27T15:09:44+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="computeIfAbsent"><a href="#computeIfAbsent" class="headerlink" title="computeIfAbsent"></a>computeIfAbsent</h2><p>这个方法是JDK8中Map类新增的一个方法，用来实现当一个KEY的值缺失的时候，使用给定的映射函数重新计算填充KEY的值并返回结果。<code>computeIfAbsent</code> 方法的JDK源码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">default</span> V <span class="title">computeIfAbsent</span><span class="params">(K key, Function&lt;? <span class="keyword">super</span> K, ? extends V&gt; mappingFunction)</span> </span>&#123;</span><br><span class="line">	Objects.requireNonNull(mappingFunction);</span><br><span class="line">	V v;</span><br><span class="line">	<span class="comment">// 尝试获取KEY的值，如果获取不到KEY</span></span><br><span class="line">	<span class="keyword">if</span> ((v = get(key)) == <span class="keyword">null</span>) &#123;</span><br><span class="line">	    V newValue;</span><br><span class="line">	    <span class="comment">// 利用传入的计算函数，得到新的值</span></span><br><span class="line">	    <span class="keyword">if</span> ((newValue = mappingFunction.apply(key)) != <span class="keyword">null</span>) &#123;</span><br><span class="line">	        <span class="comment">// 将KEY的值填充为函数计算的结果</span></span><br><span class="line">	        put(key, newValue);</span><br><span class="line">	        <span class="comment">// 返回计算的结果</span></span><br><span class="line">	        <span class="keyword">return</span> newValue;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 如果KEY的值存在，则直接返回</span></span><br><span class="line">	<span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="computeIfAbsent使用例子"><a href="#computeIfAbsent使用例子" class="headerlink" title="computeIfAbsent使用例子"></a>computeIfAbsent使用例子</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, String&gt; cache = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="comment">// 如果键的值不存在，则调用函数计算并将计算结果作为该KEY的值</span></span><br><span class="line"><span class="keyword">final</span> String key = <span class="string">"myKey"</span>;</span><br><span class="line">cache.computeIfAbsent(key, s -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">"根据"</span> + s + <span class="string">"计算新的值"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"myCacheValue"</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 第一次get，会调用映射函数</span></span><br><span class="line">System.out.println(cache.get(key));</span><br><span class="line"><span class="comment">// 第二次get，不会调用映射函数</span></span><br><span class="line">System.out.println(cache.get(key));</span><br></pre></td></tr></table></figure>
<p>程序输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">根据myKey计算新的值</span><br><span class="line">myCacheValue</span><br><span class="line">myCacheValue</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-8-collectors-reducing/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-8-collectors-reducing/" itemprop="url">Java8 - 定制归一化收集器（reducing）得到自定义结果集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-26T15:41:33+08:00">
                2018-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java8/" itemprop="url" rel="index">
                    <span itemprop="name">Java8</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-8.jpg" alt=""></p>
<h2 id="reducing简介"><a href="#reducing简介" class="headerlink" title="reducing简介"></a>reducing简介</h2><p><code>reducing</code> 是一个收集器（操作），从字面意义上可以理解为“减少操作”：输入多个元素，在一定的操作后，元素减少。</p>
<p><code>reducing</code> 有多个重载方法，其中一个方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Collector&lt;T,?,Optional&lt;T&gt;&gt; reducing(BinaryOperator&lt;T&gt; op)</span><br></pre></td></tr></table></figure>
<p>以上方法，JDK对其的描述是：</p>
<blockquote>
<p>Returns a Collector which performs a reduction of its input elements under a specified BinaryOperator. The result is described as an Optional<t>. （返回一个收集器，该收集器在指定的二进制操作符下执行其输入元素的减少。结果被描述为可选的 <code>&lt;T&gt;</code>。）</t></p>
</blockquote>
<h2 id="reducing的应用"><a href="#reducing的应用" class="headerlink" title="reducing的应用"></a>reducing的应用</h2><p><code>reducing</code> 是一个非常有用的收集器，可以用在多层流、下游数据分组或分区等场合。</p>
<p>下面是一个例子：<br>给定一组 <code>Person</code> 对象，每个 <code>Person</code> 都有 <code>city</code>（所在城市）和  <code>height</code>（身高）属性，编写一个程序，统计出每个不同的城市最大、最小身高值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.function.BinaryOperator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.groupingBy;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.reducing;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ReducingDemo</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReducingDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 运行入口</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 运行参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Person&gt; personList = getPersonList(<span class="number">1000000</span>);</span><br><span class="line">        functionStyle(personList);</span><br><span class="line">        normalStyle(personList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 函数式编程风格（3行处理代码）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> personList Person 列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">functionStyle</span><span class="params">(List&lt;Person&gt; personList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 创建一个比较器，取名为 byHeight （通过高度来比较）</span></span><br><span class="line">        Comparator&lt;Person&gt; byHeight = Comparator.comparingInt(Person::getHeight);</span><br><span class="line">        <span class="comment">// 创建一个归一收集器</span></span><br><span class="line">        Map&lt;City, Optional&lt;Person&gt;&gt; tallestByCity = personList.stream().</span><br><span class="line">                collect(groupingBy(Person::getCity, reducing(BinaryOperator.maxBy(byHeight))));</span><br><span class="line">        <span class="keyword">long</span> usedTime = System.currentTimeMillis() - start;</span><br><span class="line">        printResult(<span class="string">"函数式编程风格"</span>, personList.size(), usedTime, tallestByCity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 普通编程风格（20行处理代码）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> personList Person 列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">normalStyle</span><span class="params">(List&lt;Person&gt; personList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 创建一个结果集</span></span><br><span class="line">        Map&lt;City, Optional&lt;Person&gt;&gt; tallestByCity = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="comment">// 第一步：找出所有的不同城市</span></span><br><span class="line">        Set&lt;City&gt; cityList = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Person person : personList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!cityList.contains(person.getCity())) &#123;</span><br><span class="line">                cityList.add(person.getCity());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 第二部，遍历所有城市，遍历所有人找出每个城市的最大身高</span></span><br><span class="line">        <span class="keyword">for</span> (City city : cityList) &#123;</span><br><span class="line">            <span class="keyword">int</span> maxHeight = <span class="number">0</span>;</span><br><span class="line">            Person tempPerson = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">for</span> (Person person : personList) &#123;</span><br><span class="line">                <span class="keyword">if</span> (person.getCity().equals(city)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (person.getHeight() &gt; maxHeight) &#123;</span><br><span class="line">                        maxHeight = person.getHeight();</span><br><span class="line">                        tempPerson = person;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tallestByCity.put(city, Optional.ofNullable(tempPerson));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> usedTime = System.currentTimeMillis() - start;</span><br><span class="line">        printResult(<span class="string">"普通编程风格"</span>, personList.size(), usedTime, tallestByCity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取Person列表</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> numbers 要获取的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回指定数量的 Person 列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Person&gt; <span class="title">getPersonList</span><span class="params">(<span class="keyword">int</span> numbers)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 创建城市</span></span><br><span class="line">        <span class="keyword">final</span> City cityChengDu = <span class="keyword">new</span> City(<span class="string">"成都"</span>);</span><br><span class="line">        <span class="keyword">final</span> City cityNewYork = <span class="keyword">new</span> City(<span class="string">"纽约"</span>);</span><br><span class="line">        List&lt;Person&gt; people = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 创建指定数量的Person，并指定不同的城市和相对固定的身高值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numbers; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 成都最大身高185</span></span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityChengDu, <span class="number">185</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityChengDu, <span class="number">170</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 成都最小身高160</span></span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityChengDu, <span class="number">160</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">7</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 纽约最大身高200</span></span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityNewYork, <span class="number">200</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">9</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityNewYork, <span class="number">185</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">11</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 纽约最小身高165</span></span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityNewYork, <span class="number">165</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 默认添加纽约最小身高165</span></span><br><span class="line">                people.add(<span class="keyword">new</span> Person(cityNewYork, <span class="number">165</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> people;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出结果</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> styleName 风格名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> totalPerson 总人数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> usedTime 计算耗时</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tallestByCity 统计好最大身高的城市分组MAP</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printResult</span><span class="params">(String styleName, <span class="keyword">long</span> totalPerson, <span class="keyword">long</span> usedTime, Map&lt;City, Optional&lt;Person&gt;&gt; tallestByCity)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"\n"</span> + styleName + <span class="string">"：计算 "</span> + totalPerson + <span class="string">" 个人所在不同城市最大身高的结果如下：（耗时 "</span> + usedTime + <span class="string">" ms）"</span>);</span><br><span class="line">        tallestByCity.forEach((city, person) -&gt; &#123;</span><br><span class="line">            person.ifPresent(p -&gt; System.out.println(city.getName() + <span class="string">" -&gt; "</span> + p.getHeight()));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Person类"><a href="#Person类" class="headerlink" title="Person类"></a>Person类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Person</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所在城市</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> City city;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 身高</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> city 所在城市</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> height 身高</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(City city, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.city = city;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> City <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> city;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(City city)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.city = city;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="City类"><a href="#City类" class="headerlink" title="City类"></a>City类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * City</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zebe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">City</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 城市名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name 城市名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">City</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注</strong>：以上代码如果要计算最小值、平均值，将 <code>maxBy</code> 换成 <code>minBy</code> 就可以了。</p>
<h3 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h3><p>程序输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">函数式编程风格：计算 1000000 个人所在不同城市最大身高的结果如下：（耗时 149 ms）</span><br><span class="line">成都 -&gt; 185</span><br><span class="line">纽约 -&gt; 200</span><br><span class="line"></span><br><span class="line">普通编程风格：计算 1000000 个人所在不同城市最大身高的结果如下：（耗时 82 ms）</span><br><span class="line">成都 -&gt; 185</span><br><span class="line">纽约 -&gt; 200</span><br></pre></td></tr></table></figure></p>
<p>可以看出，函数式编程的效率不一定会比普通编程效率更高，甚至相对要慢一点，但是，<strong>函数式编程的好处</strong>在于：</p>
<ul>
<li>把参数作为一个函数，而不是值，实现了只有在需要的时候才计算（惰性求值）。</li>
<li>使用 <code>lambda</code> 表达式能够简化程序表达的含义，使程序更简洁明了。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-ten-methods-of-array/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-ten-methods-of-array/" itemprop="url">(译)Java - 数组的10个常用方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-20T10:17:49+08:00">
                2018-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-translate.jpg" alt=""><br>以下是Java数组中最常用的10种方法，它们是 <em>stackoverflow</em> 中投票最多的问题。</p>
<h2 id="0-声明数组"><a href="#0-声明数组" class="headerlink" title="0. 声明数组"></a>0. 声明数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String[] aArray = <span class="keyword">new</span> String[<span class="number">5</span>];</span><br><span class="line">String[] bArray = &#123;<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>&#125;;</span><br><span class="line">String[] cArray = <span class="keyword">new</span> String[]&#123;<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="1-打印数组"><a href="#1-打印数组" class="headerlink" title="1. 打印数组"></a>1. 打印数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] intArray = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line">String intArrayString = Arrays.toString(intArray);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// print directly will print reference value</span></span><br><span class="line">System.out.println(intArray);</span><br><span class="line"><span class="comment">// [I@7150bd4d</span></span><br><span class="line"> </span><br><span class="line">System.out.println(intArrayString);</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h2 id="2-从数组创建一个-ArrayList"><a href="#2-从数组创建一个-ArrayList" class="headerlink" title="2. 从数组创建一个 ArrayList"></a>2. 从数组创建一个 ArrayList</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] stringArray = &#123; <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span> &#125;;</span><br><span class="line">ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;String&gt;(Arrays.asList(stringArray));</span><br><span class="line">System.out.println(arrayList);</span><br><span class="line"><span class="comment">// [a, b, c, d, e]</span></span><br></pre></td></tr></table></figure>
<h2 id="3-检查数组是否包含某一个值"><a href="#3-检查数组是否包含某一个值" class="headerlink" title="3. 检查数组是否包含某一个值"></a>3. 检查数组是否包含某一个值</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] stringArray = &#123; <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span> &#125;;</span><br><span class="line"><span class="keyword">boolean</span> b = Arrays.asList(stringArray).contains(<span class="string">"a"</span>);</span><br><span class="line">System.out.println(b);</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-合并数组"><a href="#4-合并数组" class="headerlink" title="4. 合并数组"></a>4. 合并数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] intArray = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">int</span>[] intArray2 = &#123; <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span> &#125;;</span><br><span class="line"><span class="comment">// Apache Commons Lang library</span></span><br><span class="line"><span class="keyword">int</span>[] combinedIntArray = ArrayUtils.addAll(intArray, intArray2);</span><br></pre></td></tr></table></figure>
<h2 id="5-一行代码声明数组"><a href="#5-一行代码声明数组" class="headerlink" title="5. 一行代码声明数组"></a>5. 一行代码声明数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method(<span class="keyword">new</span> String[]&#123;<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="6-把数组中的元素用指定的分隔符连接起来"><a href="#6-把数组中的元素用指定的分隔符连接起来" class="headerlink" title="6. 把数组中的元素用指定的分隔符连接起来"></a>6. 把数组中的元素用指定的分隔符连接起来</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// containing the provided list of elements</span></span><br><span class="line"><span class="comment">// Apache common lang</span></span><br><span class="line">String j = StringUtils.join(<span class="keyword">new</span> String[] &#123; <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span> &#125;, <span class="string">", "</span>);</span><br><span class="line">System.out.println(j);</span><br><span class="line"><span class="comment">// a, b, c</span></span><br></pre></td></tr></table></figure>
<h2 id="7-把一个-ArrayList-转换成数组"><a href="#7-把一个-ArrayList-转换成数组" class="headerlink" title="7. 把一个 ArrayList 转换成数组"></a>7. 把一个 ArrayList 转换成数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String[] stringArray = &#123; <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span> &#125;;</span><br><span class="line">ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;String&gt;(Arrays.asList(stringArray));</span><br><span class="line">String[] stringArr = <span class="keyword">new</span> String[arrayList.size()];</span><br><span class="line">arrayList.toArray(stringArr);</span><br><span class="line"><span class="keyword">for</span> (String s : stringArr)</span><br><span class="line">	System.out.println(s);</span><br></pre></td></tr></table></figure>
<h2 id="8-把一个数组转换成-Set"><a href="#8-把一个数组转换成-Set" class="headerlink" title="8. 把一个数组转换成 Set"></a>8. 把一个数组转换成 Set</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;String&gt; set = <span class="keyword">new</span> HashSet&lt;String&gt;(Arrays.asList(stringArray));</span><br><span class="line">System.out.println(set);</span><br><span class="line"><span class="comment">//[d, e, b, c, a]</span></span><br></pre></td></tr></table></figure>
<h2 id="9-反转数组"><a href="#9-反转数组" class="headerlink" title="9. 反转数组"></a>9. 反转数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] intArray = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line">ArrayUtils.reverse(intArray);</span><br><span class="line">System.out.println(Arrays.toString(intArray));</span><br><span class="line"><span class="comment">//[5, 4, 3, 2, 1]</span></span><br></pre></td></tr></table></figure>
<h2 id="10-移除数组中的元素"><a href="#10-移除数组中的元素" class="headerlink" title="10. 移除数组中的元素"></a>10. 移除数组中的元素</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] intArray = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">int</span>[] removed = ArrayUtils.removeElement(intArray, <span class="number">3</span>);<span class="comment">//create a new array</span></span><br><span class="line">System.out.println(Arrays.toString(removed));</span><br></pre></td></tr></table></figure>
<h2 id="附加的方法-把-int-转换成字节数组"><a href="#附加的方法-把-int-转换成字节数组" class="headerlink" title="附加的方法 - 把 int 转换成字节数组"></a>附加的方法 - 把 int 转换成字节数组</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] bytes = ByteBuffer.allocate(<span class="number">4</span>).putInt(<span class="number">8</span>).array();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">byte</span> t : bytes) &#123;</span><br><span class="line">   System.out.format(<span class="string">"0x%x "</span>, t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>版权声明：本文为译文，请尊重原作者，转载请保留原文链接：<a href="https://www.programcreek.com/2013/09/top-10-methods-for-java-arrays/" target="_blank" rel="noopener">https://www.programcreek.com/2013/09/top-10-methods-for-java-arrays/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/java-what-exactly-is-null/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/java-what-exactly-is-null/" itemprop="url">(译)Java - null在内存中到底是什么</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-20T10:17:49+08:00">
                2018-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/cover/cover-java-translate.jpg" alt=""><br>Java中随时都在使用 <code>null</code>，那么 <code>null</code> 到底是什么？让我们从一个简单的表达式说起：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String x = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h2 id="1-这句话的确切含义是什么？"><a href="#1-这句话的确切含义是什么？" class="headerlink" title="1. 这句话的确切含义是什么？"></a>1. 这句话的确切含义是什么？</h2><p>回想什么是变量，什么是值。一个常见的隐喻是一个变量类似于一个盒子。就像你可以用一个盒子来存储东西一样，你可以使用变量来存储一个值。在声明变量时，我们需要设置变量的类型。</p>
<p>Java中有两大类类型：<strong>原始类型</strong>和<strong>引用类型</strong>。声明原始类型存储值的变量；引用类型存储引用声明的变量。在这种情况下，初始化语句声明一个变量 <code>x</code>。<code>x</code>存储字符串引用，这里的引用是 null。</p>
<p>下面的可视化给出了一个更好的概念。<br><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/what-is-null-150x150.png" alt=""></p>
<p>如果 <code>x = &quot;abc&quot;</code>，它看起来如下：<br><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/variable-reference-300x144.png" alt=""></p>
<h2 id="2-内存中的null究竟是什么？"><a href="#2-内存中的null究竟是什么？" class="headerlink" title="2. 内存中的null究竟是什么？"></a>2. 内存中的null究竟是什么？</h2><p>内存中的null究竟是什么？或者Java中的 null 是什么？</p>
<p>首先，null不是有效的对象实例，因此没有为它分配内存。它只是一个值，指示对象引用当前不引用对象。</p>
<p>来自JVM规范：</p>
<blockquote>
<p>The Java Virtual Machine specification does not mandate a concrete value encoding null.（Java虚拟机规范并没有授权一个具体的值编码null。）</p>
</blockquote>
<p>我假设它是类似于其他C类语言的所有零。</p>
<h2 id="3-x在内存中到底是什么？"><a href="#3-x在内存中到底是什么？" class="headerlink" title="3. x在内存中到底是什么？"></a>3. x在内存中到底是什么？</h2><p>现在我们知道 <code>null</code> 是什么。我们知道一个变量是一个存储位置和一个相关的符号名称（标识符），它包含一些值。</p>
<p>x在内存中的确切位置？从JVM运行时数据区域的图中，我们知道，由于每个方法都具有线程堆栈内的私有堆栈帧，因此本地变量位于该帧上。</p>
<p>版权声明：本文为译文，请尊重原作者，转载请保留原文链接：<a href="https://www.programcreek.com/2013/12/what-exactly-is-null-in-java/" target="_blank" rel="noopener">https://www.programcreek.com/2013/12/what-exactly-is-null-in-java/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.nichuan.top/win-10-activate/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="倪川">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nichuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/win-10-activate/" itemprop="url">Windows10“许可证即将过期”解决办法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-18T16:53:34+08:00">
                2018-09-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/系统/" itemprop="url" rel="index">
                    <span itemprop="name">系统</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/系统/Windows/" itemprop="url" rel="index">
                    <span itemprop="name">Windows</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www-zebe-me.oss-cn-beijing.aliyuncs.com/win-10.jpg" alt=""><br>试了很多激活工具、激活码都不行，本文介绍的这个激活方法截止到今日（2018年9月18日）是可行的，亲测通过。</p>
<p><strong>第1步</strong>：以管理员模式打开命令提示符号（或者PowerShell）。<br><strong>第2步</strong>：在命令窗口中依次输入以下内容（加粗部分）：</p>
<ul>
<li><strong>slmgr.vbs /upk</strong>：稍等几秒钟，窗口会弹出“成功地卸载了产品密钥”。</li>
<li><strong>slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX</strong>：稍等几秒钟，窗口会弹出“成功的安装了产品密钥”。</li>
<li><strong>slmgr /skms zh.us.to</strong>：稍等几秒钟，窗口会弹出“密钥管理服务计算机名成功地设置为 zh.us.to”。</li>
<li><strong>slmgr /ato</strong>：稍等十秒钟左右，窗口会弹出“成功的激活了产品”。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">倪川</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">97</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">倪川</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
